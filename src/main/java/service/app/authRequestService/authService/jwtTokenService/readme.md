# JWT Token Service

The JWT Token Service is a part of the authentication service in our application. It is responsible for generating and verifying JSON Web Tokens (JWTs) which are used for secure communication between the client and the server.

## Components

### RsaEncryptDecryptMessage

This component is responsible for encrypting and decrypting messages using RSA encryption. It uses the RSA key generated by `RuntimeRsaKeyGenerator` for encryption and decryption.

### RuntimeRsaKeyGenerator

This component generates an RSA key at runtime. The generated key is used by `RsaEncryptDecryptMessage` for encryption and decryption.

### JwtToken

This component is responsible for generating and decoding JWTs. The generated JWTs are encrypted using RSA encryption for added security.

### RuntimeSecretKeyGenerator

This component generates a secret key at runtime. This secret key is used by `JwtToken` for generating and decoding JWTs.

### EncryptedJwtTokenService

This is the main service that uses all the above components. It provides methods to generate an RSA-encrypted JWT token and to verify if a token corresponds to a user. The generated token is encrypted using RSA encryption and the secret key from `RuntimeSecretKeyGenerator`. The verification process involves decrypting the token and then decoding the JWT to verify the user details.

## Workflow

1. When a token needs to be generated, `EncryptedJwtTokenService` calls `JwtToken` to generate a JWT using the secret key from `RuntimeSecretKeyGenerator`.
2. The generated JWT is then encrypted using RSA encryption by `RsaEncryptDecryptMessage` with the RSA key from `RuntimeRsaKeyGenerator`.
3. The encrypted token is then sent to the client.
4. When a token needs to be verified, `EncryptedJwtTokenService` first decrypts the token using `RsaEncryptDecryptMessage` and the RSA key from `RuntimeRsaKeyGenerator`.
5. The decrypted token is a JWT, which is then decoded by `JwtToken` using the secret key from `RuntimeSecretKeyGenerator`.
6. The decoded JWT is then used to verify the user details.